
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-97947441-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>tick.linear_model &#8212; tick 0.6.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tick.linear_model.LinearRegression" href="generated/tick.linear_model.LinearRegression.html" />
    <link rel="prev" title="tick.hawkes.ModelHawkesSumExpKernLogLik" href="generated/tick.hawkes.ModelHawkesSumExpKernLogLik.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="None navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          tick</a>
        <span class="navbar-text navbar-version pull-left"><b>0.6</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../index.html">Home</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="api.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Browse <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="hawkes.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tick.hawkes</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="hawkes.html#introduction">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="hawkes.html#learners">2. Learners</a></li>
<li class="toctree-l2"><a class="reference internal" href="hawkes.html#point-process-simulation">3. Point process simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="hawkes.html#models-for-inference">4. Models for inference</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tick.linear_model</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#learners">2. Learners</a></li>
<li class="toctree-l2"><a class="reference internal" href="#models">3. Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simulation">4. Simulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="robust.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tick.robust</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="robust.html#regression-with-individual-intercepts">1. Regression with individual intercepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="robust.html#robust-losses">2. Robust losses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="survival.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tick.survival</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="survival.html#learners">1. Learners</a></li>
<li class="toctree-l2"><a class="reference internal" href="survival.html#models">2. Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="survival.html#simulation">3. Simulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="prox.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tick.prox</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="prox.html#available-operators">1. Available operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="prox.html#example">2. Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="prox.html#how-to-combine-several-prox">3. How to combine several prox ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="prox.html#the-prox-class-api">4. The <code class="docutils literal notranslate"><span class="pre">prox</span></code> class API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="solver.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tick.solver</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="solver.html#the-solver-class-api">1. The <code class="docutils literal notranslate"><span class="pre">solver</span></code> class API</a></li>
<li class="toctree-l2"><a class="reference internal" href="solver.html#available-solvers">2. Available solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="solver.html#example">3. Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="simulation.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tick.simulation</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="simulation.html#simulation-of-model-weights">1. Simulation of model weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulation.html#simulation-of-a-features-matrix">2. Simulation of a features matrix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plot.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tick.plot</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="plot.html#history-plot">1. History plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot.html#plots-for-hawkes-processes">2. Plots for Hawkes processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot.html#plots-for-point-process-simulation">3. Plots for point process simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot.html#miscellaneous-plots">4. Miscellaneous plots</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tick.dataset</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/tick.dataset.fetch_tick_dataset.html">tick.dataset.fetch_tick_dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/tick.dataset.fetch_hawkes_bund_data.html">tick.dataset.fetch_hawkes_bund_data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tick.preprocessing</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="preprocessing.html#preprocessing-for-static-features">Preprocessing for static features</a></li>
<li class="toctree-l2"><a class="reference internal" href="preprocessing.html#preprocessing-for-longitudinal-features">Preprocessing for longitudinal features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tick.metrics</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/tick.metrics.support_fdp.html">tick.metrics.support_fdp</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/tick.metrics.support_recall.html">tick.metrics.support_recall</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="R.html">How to use <code class="docutils literal notranslate"><span class="pre">tick</span></code> from the R statistical software</a><ul>
<li class="toctree-l2"><a class="reference internal" href="R.html#training-a-logistic-regression-model">1. Training a logistic regression model</a></li>
<li class="toctree-l2"><a class="reference internal" href="R.html#simulation-of-a-hawkes-process">2. Simulation of a Hawkes process</a></li>
<li class="toctree-l2"><a class="reference internal" href="R.html#using-optimization-tools-from-r">3. Using optimization tools from R</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dev.html">Developer documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dev.html#main-highlights">Main highlights</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev.html#base-class">Base class</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev.html#how-to-add-a-new-model-solver-or-prox">How to add a new model, solver or prox</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev.html#enable-python-pickling-of-c-objects">Enable Python-pickling of C++ objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev.html#tips-for-debugging-c-classes-in-tick">Tips for debugging C++ classes in tick</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#table-of-contents">Table of contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#hawkes"><span class="xref std std-ref">hawkes</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#linear-model"><span class="xref std std-ref">linear_model</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#robust"><span class="xref std std-ref">robust</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#survival"><span class="xref std std-ref">survival</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#prox"><span class="xref std std-ref">prox</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#solver"><span class="xref std std-ref">solver</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#api-simulation"><span class="xref std std-ref">simulation</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#plot"><span class="xref std std-ref">plot</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#dataset"><span class="xref std std-ref">dataset</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#preprocessing"><span class="xref std std-ref">preprocessing</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#metrics"><span class="xref std std-ref">metrics</span></a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container content-container">
  
  <div class="section" id="tick-linear-model">
<span id="linear-model"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">tick.linear_model</span></code><a class="headerlink" href="#tick-linear-model" title="Permalink to this headline">¶</a></h1>
<p>This module proposes tools for the inference and simulation of (generalized)
linear models, including among others linear, logistic and Poisson regression,
with a large set of penalization techniques and solvers.
It also proposes hinge losses for supervised learning, namely the hinge,
quadratic hinge and smoothed hinge losses.</p>
<div class="section" id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Given training data <span class="math notranslate nohighlight">\((x_i, y_i) \in \mathbb R^d \times \mathbb R\)</span>
for <span class="math notranslate nohighlight">\(i=1, \ldots, n\)</span>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">tick</span></code> considers, when solving a generalized linear
model an objective of the form</p>
<div class="math notranslate nohighlight">
\[\frac 1n \sum_{i=1}^n \ell(y_i, x_i^\top w + b) + g(w),\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w \in \mathbb R^d\)</span> is a vector containing the model weights;</p></li>
<li><p><span class="math notranslate nohighlight">\(b \in \mathbb R\)</span> is the population intercept;</p></li>
<li><p><span class="math notranslate nohighlight">\(\ell : \mathbb R^2 \rightarrow \mathbb R\)</span> is a loss function</p></li>
<li><p><span class="math notranslate nohighlight">\(g\)</span> is a penalization function, see <a class="reference internal" href="prox.html#prox"><span class="std std-ref">tick.prox</span></a> for a list of available penalization technique</p></li>
</ul>
<p>Depending on the model the label can be binary <span class="math notranslate nohighlight">\(y_i \in \{ -1, 1 \}\)</span>
(binary classification), discrete <span class="math notranslate nohighlight">\(y_i \in \mathbb N\)</span> (Poisson models,
see below) or continuous <span class="math notranslate nohighlight">\(y_i \in \mathbb R\)</span> (least-squares regression).
The loss function <span class="math notranslate nohighlight">\(\ell\)</span> depends on the considered model, that are listed
in <a class="reference internal" href="#linear-model-model"><span class="std std-ref">3. Models</span></a> below. This modules proposes also end-user
learner classes described below.</p>
</div>
<div class="section" id="learners">
<h2>2. Learners<a class="headerlink" href="#learners" title="Permalink to this headline">¶</a></h2>
<p>The following table lists the different learners that allows to train a
model with several choices of penalizations and solvers.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/tick.linear_model.LinearRegression.html#tick.linear_model.LinearRegression" title="tick.linear_model.LinearRegression"><code class="xref py py-obj docutils literal notranslate"><span class="pre">linear_model.LinearRegression</span></code></a>([…])</p></td>
<td><p>Linear regression learner, with many choices of penalization and solvers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/tick.linear_model.LogisticRegression.html#tick.linear_model.LogisticRegression" title="tick.linear_model.LogisticRegression"><code class="xref py py-obj docutils literal notranslate"><span class="pre">linear_model.LogisticRegression</span></code></a>([…])</p></td>
<td><p>Logistic regression learner, with many choices of penalization and solvers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/tick.linear_model.PoissonRegression.html#tick.linear_model.PoissonRegression" title="tick.linear_model.PoissonRegression"><code class="xref py py-obj docutils literal notranslate"><span class="pre">linear_model.PoissonRegression</span></code></a>([step, …])</p></td>
<td><p>Poisson regression learner, with exponential link function.</p></td>
</tr>
</tbody>
</table>
<p>These classes follow whenever possible the scikit-learn API, namely <code class="docutils literal notranslate"><span class="pre">fit</span></code>
and <code class="docutils literal notranslate"><span class="pre">predict</span></code> methods, and follow the same naming conventions.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">==============================================</span>
<span class="sd">Binary classification with logistic regression</span>
<span class="sd">==============================================</span>

<span class="sd">This code perform binary classification on adult dataset with logistic</span>
<span class="sd">regression learner (`tick.inference.LogisticRegression`).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>

<span class="kn">from</span> <span class="nn">tick.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">tick.dataset</span> <span class="kn">import</span> <span class="n">fetch_tick_dataset</span>

<span class="n">train_set</span> <span class="o">=</span> <span class="n">fetch_tick_dataset</span><span class="p">(</span><span class="s1">&#39;binary/adult/adult.trn.bz2&#39;</span><span class="p">)</span>
<span class="n">test_set</span> <span class="o">=</span> <span class="n">fetch_tick_dataset</span><span class="p">(</span><span class="s1">&#39;binary/adult/adult.tst.bz2&#39;</span><span class="p">)</span>

<span class="n">learner</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">learner</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_set</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">train_set</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">predictions</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_set</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">test_set</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">predictions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ROC curve on adult dataset (area = {:.2f})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;True Positive Rate&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;False Positive Rate&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../examples/plot_logistic_adult.py">Source code</a>, <a class="reference external" href="../../examples/plot_logistic_adult.png">png</a>, <a class="reference external" href="../../examples/plot_logistic_adult.hires.png">hires.png</a>, <a class="reference external" href="../../examples/plot_logistic_adult.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/plot_logistic_adult1.png" src="../_images/plot_logistic_adult1.png" />
</div>
</div>
</div>
<div class="section" id="models">
<span id="linear-model-model"></span><h2>3. Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">tick</span></code> a <code class="docutils literal notranslate"><span class="pre">model</span></code> class gives information about a statistical model.
Depending on the case, it gives first order information (loss, gradient) or
second order information (hessian norm evaluation).
In this module, a model corresponds to the choice of a loss function, that are
described below. The advantages of using one or another loss are explained in
the documentation of the classes themselves.
The following table lists the different losses implemented for now in this
module, its associated class and label type.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 11%" />
<col style="width: 8%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Model</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Label type</p></th>
<th class="head"><p>Class</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Linear regression</p></td>
<td><p>Regression</p></td>
<td><p>Continuous</p></td>
<td><p><a class="reference internal" href="generated/tick.linear_model.ModelLinReg.html#tick.linear_model.ModelLinReg" title="tick.linear_model.ModelLinReg"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelLinReg</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>Logistic regression</p></td>
<td><p>Classification</p></td>
<td><p>Binary</p></td>
<td><p><a class="reference internal" href="generated/tick.linear_model.ModelLogReg.html#tick.linear_model.ModelLogReg" title="tick.linear_model.ModelLogReg"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelLogReg</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>Poisson regression (identity link)</p></td>
<td><p>Count data</p></td>
<td><p>Integer</p></td>
<td><p><a class="reference internal" href="generated/tick.linear_model.ModelPoisReg.html#tick.linear_model.ModelPoisReg" title="tick.linear_model.ModelPoisReg"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelPoisReg</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>Poisson regression (exponential link)</p></td>
<td><p>Count data</p></td>
<td><p>Integer</p></td>
<td><p><a class="reference internal" href="generated/tick.linear_model.ModelPoisReg.html#tick.linear_model.ModelPoisReg" title="tick.linear_model.ModelPoisReg"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelPoisReg</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>Hinge loss</p></td>
<td><p>Classification</p></td>
<td><p>Binary</p></td>
<td><p><a class="reference internal" href="generated/tick.linear_model.ModelHinge.html#tick.linear_model.ModelHinge" title="tick.linear_model.ModelHinge"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelHinge</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>Quadratic hinge loss</p></td>
<td><p>Classification</p></td>
<td><p>Binary</p></td>
<td><p><a class="reference internal" href="generated/tick.linear_model.ModelQuadraticHinge.html#tick.linear_model.ModelQuadraticHinge" title="tick.linear_model.ModelQuadraticHinge"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelQuadraticHinge</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>Smoothed hinge loss</p></td>
<td><p>Classification</p></td>
<td><p>Binary</p></td>
<td><p><a class="reference internal" href="generated/tick.linear_model.ModelSmoothedHinge.html#tick.linear_model.ModelSmoothedHinge" title="tick.linear_model.ModelSmoothedHinge"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelSmoothedHinge</span></code></a></p></td>
</tr>
</tbody>
</table>
<div class="section" id="description-of-the-available-models">
<h3>3.1. Description of the available models<a class="headerlink" href="#description-of-the-available-models" title="Permalink to this headline">¶</a></h3>
<p>On the following graph we represent the different losses available in tick for
supervised linear learning. Note that <a class="reference internal" href="generated/tick.robust.ModelHuber.html#tick.robust.ModelHuber" title="tick.robust.ModelHuber"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelHuber</span></code></a>,
<a class="reference internal" href="generated/tick.robust.ModelEpsilonInsensitive.html#tick.robust.ModelEpsilonInsensitive" title="tick.robust.ModelEpsilonInsensitive"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelEpsilonInsensitive</span></code></a>,
<a class="reference internal" href="generated/tick.robust.ModelModifiedHuber.html#tick.robust.ModelModifiedHuber" title="tick.robust.ModelModifiedHuber"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelModifiedHuber</span></code></a> and
<a class="reference internal" href="generated/tick.robust.ModelAbsoluteRegression.html#tick.robust.ModelAbsoluteRegression" title="tick.robust.ModelAbsoluteRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelAbsoluteRegression</span></code></a> are available
through the <a class="reference internal" href="robust.html#robust"><span class="std std-ref">tick.robust</span></a> module.</p>
<p>(<a class="reference external" href="../modules/code_samples/plot_linear_model_losses.py">Source code</a>, <a class="reference external" href="../modules/code_samples/plot_linear_model_losses.png">png</a>, <a class="reference external" href="../modules/code_samples/plot_linear_model_losses.hires.png">hires.png</a>, <a class="reference external" href="../modules/code_samples/plot_linear_model_losses.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/plot_linear_model_losses1.png" src="../_images/plot_linear_model_losses1.png" />
</div>
<div class="section" id="modellinreg">
<h4><a class="reference internal" href="generated/tick.linear_model.ModelLinReg.html#tick.linear_model.ModelLinReg" title="tick.linear_model.ModelLinReg"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelLinReg</span></code></a><a class="headerlink" href="#modellinreg" title="Permalink to this headline">¶</a></h4>
<p>This is least-squares regression with loss</p>
<div class="math notranslate nohighlight">
\[\ell(y, y') = \frac 12 (y - y')^2\]</div>
<p>for <span class="math notranslate nohighlight">\(y, y' \in \mathbb R\)</span></p>
</div>
<hr class="docutils" />
<div class="section" id="modellogreg">
<h4><a class="reference internal" href="generated/tick.linear_model.ModelLogReg.html#tick.linear_model.ModelLogReg" title="tick.linear_model.ModelLogReg"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelLogReg</span></code></a><a class="headerlink" href="#modellogreg" title="Permalink to this headline">¶</a></h4>
<p>Logistic regression for binary classification with loss</p>
<div class="math notranslate nohighlight">
\[\ell(y, y') = \log(1 + \exp(-y y'))\]</div>
<p>for <span class="math notranslate nohighlight">\(y \in \{ -1, 1\}\)</span> and <span class="math notranslate nohighlight">\(y' \in \mathbb R\)</span></p>
</div>
<hr class="docutils" />
<div class="section" id="modelhinge">
<h4><a class="reference internal" href="generated/tick.linear_model.ModelHinge.html#tick.linear_model.ModelHinge" title="tick.linear_model.ModelHinge"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelHinge</span></code></a><a class="headerlink" href="#modelhinge" title="Permalink to this headline">¶</a></h4>
<p>This is the hinge loss for binary classification given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\ell(y, y') =
\begin{cases}
1 - y y' &amp;\text{ if } y y' &lt; 1 \\
0 &amp;\text{ if } y y' \geq 1
\end{cases}\end{split}\]</div>
<p>for <span class="math notranslate nohighlight">\(y \in \{ -1, 1\}\)</span> and <span class="math notranslate nohighlight">\(y' \in \mathbb R\)</span></p>
</div>
<hr class="docutils" />
<div class="section" id="modelquadratichinge">
<h4><a class="reference internal" href="generated/tick.linear_model.ModelQuadraticHinge.html#tick.linear_model.ModelQuadraticHinge" title="tick.linear_model.ModelQuadraticHinge"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelQuadraticHinge</span></code></a><a class="headerlink" href="#modelquadratichinge" title="Permalink to this headline">¶</a></h4>
<p>This is the quadratic hinge loss for binary classification given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\ell(y, y') =
\begin{cases}
\frac 12 (1 - y y')^2 &amp;\text{ if } y y' &lt; 1 \\
0 &amp;\text{ if } y y' \geq 1
\end{cases}\end{split}\]</div>
<p>for <span class="math notranslate nohighlight">\(y \in \{ -1, 1\}\)</span> and <span class="math notranslate nohighlight">\(y' \in \mathbb R\)</span></p>
</div>
<hr class="docutils" />
<div class="section" id="modelsmoothedhinge">
<h4><a class="reference internal" href="generated/tick.linear_model.ModelSmoothedHinge.html#tick.linear_model.ModelSmoothedHinge" title="tick.linear_model.ModelSmoothedHinge"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelSmoothedHinge</span></code></a><a class="headerlink" href="#modelsmoothedhinge" title="Permalink to this headline">¶</a></h4>
<p>This is the smoothed hinge loss for binary classification given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\ell(y, y') =
\begin{cases}
1 - y y' - \frac \delta 2 &amp;\text{ if } y y' \leq 1 - \delta \\
\frac{(1 - y y')^2}{2 \delta} &amp;\text{ if } 1 - \delta &lt; y y' &lt; 1 \\
0 &amp;\text{ if } y y' \geq 1
\end{cases}\end{split}\]</div>
<p>for <span class="math notranslate nohighlight">\(y \in \{ -1, 1\}\)</span> and <span class="math notranslate nohighlight">\(y' \in \mathbb R\)</span>,
where <span class="math notranslate nohighlight">\(\delta \in (0, 1)\)</span> can be tuned using the <code class="docutils literal notranslate"><span class="pre">smoothness</span></code> parameter.
Note that <span class="math notranslate nohighlight">\(\delta = 0\)</span> corresponds to the hinge loss.</p>
</div>
<hr class="docutils" />
<div class="section" id="modelpoisreg">
<h4><a class="reference internal" href="generated/tick.linear_model.ModelPoisReg.html#tick.linear_model.ModelPoisReg" title="tick.linear_model.ModelPoisReg"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelPoisReg</span></code></a><a class="headerlink" href="#modelpoisreg" title="Permalink to this headline">¶</a></h4>
<p>Poisson regression with exponential link with loss corresponds to the loss</p>
<div class="math notranslate nohighlight">
\[\ell(y, y') = e^{y'} - y y'\]</div>
<p>for <span class="math notranslate nohighlight">\(y \in \mathbb N\)</span> and <span class="math notranslate nohighlight">\(y' \in \mathbb R\)</span> and is obtained
using <code class="docutils literal notranslate"><span class="pre">link='exponential'</span></code>. Poisson regression with identity link, namely with loss</p>
<div class="math notranslate nohighlight">
\[\ell(y, y') = y' - y \log(y')\]</div>
<p>for <span class="math notranslate nohighlight">\(y \in \mathbb N\)</span> and <span class="math notranslate nohighlight">\(y' &gt; 0\)</span> is obtained using
<code class="docutils literal notranslate"><span class="pre">link='identity'</span></code>.</p>
</div>
</div>
<div class="section" id="the-model-class-api">
<h3>3.2. The <code class="docutils literal notranslate"><span class="pre">model</span></code> class API<a class="headerlink" href="#the-model-class-api" title="Permalink to this headline">¶</a></h3>
<p>All model classes allow to compute the loss (value of the objective function <span class="math notranslate nohighlight">\(f\)</span>) and
its gradient. Let us illustrate this with the logistic regression model.
First, we need to simulate data.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">tick.linear_model</span> <span class="k">import</span> <span class="n">SimuLogReg</span>
<span class="kn">from</span> <span class="nn">tick.simulation</span> <span class="k">import</span> <span class="n">weights_sparse_gauss</span>

<span class="n">n_samples</span><span class="p">,</span> <span class="n">n_features</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">50</span>
<span class="n">weights0</span> <span class="o">=</span> <span class="n">weights_sparse_gauss</span><span class="p">(</span><span class="n">n_weights</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span> <span class="n">nnz</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">intercept0</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SimuLogReg</span><span class="p">(</span><span class="n">weights0</span><span class="p">,</span> <span class="n">intercept</span><span class="o">=</span><span class="n">intercept0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
                  <span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
</pre></div>
</div>
<p>Now, we can create the model object for logistic regression</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">tick.linear_model</span> <span class="k">import</span> <span class="n">ModelLogReg</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ModelLogReg</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<p>outputs</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
  &quot;dtype&quot;: &quot;float64&quot;,
  &quot;fit_intercept&quot;: true,
  &quot;n_calls_grad&quot;: 0,
  &quot;n_calls_loss&quot;: 0,
  &quot;n_calls_loss_and_grad&quot;: 0,
  &quot;n_coeffs&quot;: 51,
  &quot;n_features&quot;: 50,
  &quot;n_passes_over_data&quot;: 0,
  &quot;n_samples&quot;: 2000,
  &quot;n_threads&quot;: 1,
  &quot;name&quot;: &quot;ModelLogReg&quot;
}
</pre></div>
</div>
<p>Printing any object in tick returns a json formatted description of it.
We see that this model uses 50 features, 51 coefficients (including the intercept),
and that it received 2000 sample points. Now we can compute the loss of the model using
the <code class="docutils literal notranslate"><span class="pre">loss</span></code> method (its objective, namely the value of the function <span class="math notranslate nohighlight">\(f\)</span>
to be minimized) by using</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">coeffs0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">weights0</span><span class="p">,</span> <span class="p">[</span><span class="n">intercept0</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">loss</span><span class="p">(</span><span class="n">coeffs0</span><span class="p">))</span>
</pre></div>
</div>
<p>which outputs</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mf">0.3551082120992899</span>
</pre></div>
</div>
<p>while</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">loss</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">n_coeffs</span><span class="p">)))</span>
</pre></div>
</div>
<p>outputs</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mf">5.793300908869233</span>
</pre></div>
</div>
<p>which is explained by the fact that the loss is larger for a parameter which is far from
the ones used for the simulation.
The gradient of the model can be computed using the <code class="docutils literal notranslate"><span class="pre">grad</span></code> method</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">coeffs0</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\nabla f(\mathrm{coeffs0})$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">n_coeffs</span><span class="p">)))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\nabla f(\mathrm{coeffs1})$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
<p>which plots</p>
<p>(<a class="reference external" href="../modules/code_samples/plot_grad_coeff0.py">Source code</a>, <a class="reference external" href="../modules/code_samples/plot_grad_coeff0.png">png</a>, <a class="reference external" href="../modules/code_samples/plot_grad_coeff0.hires.png">hires.png</a>, <a class="reference external" href="../modules/code_samples/plot_grad_coeff0.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/plot_grad_coeff01.png" src="../_images/plot_grad_coeff01.png" />
</div>
<p>We observe that the gradient near the optimum is much smaller than far from it.
Model classes can be used with any solver class, by simply passing them through
the solver’s <code class="docutils literal notranslate"><span class="pre">set_model</span></code> method, see <a class="reference internal" href="solver.html#solver"><span class="std std-ref">tick.solver</span></a>.</p>
<p id="simulation-linear-model"><strong>What’s under the hood?</strong></p>
<p>All model classes have a <code class="docutils literal notranslate"><span class="pre">loss</span></code> and <code class="docutils literal notranslate"><span class="pre">grad</span></code> method, that are used by batch
algorithms to fit the model. These classes contains a C++ object, that does the
computations. Some methods are hidden within this C++ object, and are accessible
only through C++ (such as <code class="docutils literal notranslate"><span class="pre">loss_i</span></code> and <code class="docutils literal notranslate"><span class="pre">grad_i</span></code> that compute the gradient
using the single data point <span class="math notranslate nohighlight">\((x_i, y_i)\)</span>). These hidden methods are used
in the stochastic solvers, and are available through C++ only for efficiency.</p>
</div>
</div>
<div class="section" id="simulation">
<h2>4. Simulation<a class="headerlink" href="#simulation" title="Permalink to this headline">¶</a></h2>
<p>Simulation of several linear models can be done using the following classes.
All simulation classes simulates a features matrix <span class="math notranslate nohighlight">\(\boldsymbol X\)</span> with rows <span class="math notranslate nohighlight">\(x_i\)</span>
and a labels vector <span class="math notranslate nohighlight">\(y\)</span> with coordinates <span class="math notranslate nohighlight">\(y_i\)</span> for <span class="math notranslate nohighlight">\(i=1, \ldots, n\)</span>, that
are i.i.d realizations of a random vector <span class="math notranslate nohighlight">\(X\)</span> and a scalar random variable <span class="math notranslate nohighlight">\(Y\)</span>.
The conditional distribution of <span class="math notranslate nohighlight">\(Y | X\)</span> is <span class="math notranslate nohighlight">\(\mathbb P(Y=y | X=x)\)</span>,
where <span class="math notranslate nohighlight">\(\mathbb P\)</span> depends on the considered model.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 28%" />
<col style="width: 49%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Model</p></th>
<th class="head"><p>Distribution <span class="math notranslate nohighlight">\(\mathbb P(Y=y | X=x)\)</span></p></th>
<th class="head"><p>Class</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Linear regression</p></td>
<td><p><span class="math notranslate nohighlight">\(\text{Normal}(w^\top x + b, \sigma^2)\)</span></p></td>
<td><p><a class="reference internal" href="generated/tick.linear_model.SimuLinReg.html#tick.linear_model.SimuLinReg" title="tick.linear_model.SimuLinReg"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimuLinReg</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>Logistic regression</p></td>
<td><p><span class="math notranslate nohighlight">\(\text{Binomial}(w^\top x + b)\)</span></p></td>
<td><p><a class="reference internal" href="generated/tick.linear_model.SimuLogReg.html#tick.linear_model.SimuLogReg" title="tick.linear_model.SimuLogReg"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimuLogReg</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>Poisson regression (identity link)</p></td>
<td><p><span class="math notranslate nohighlight">\(\text{Poisson}(w^\top x + b)\)</span></p></td>
<td><p><a class="reference internal" href="generated/tick.linear_model.SimuPoisReg.html#tick.linear_model.SimuPoisReg" title="tick.linear_model.SimuPoisReg"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimuPoisReg</span></code></a> with <code class="docutils literal notranslate"><span class="pre">link=&quot;identity&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Poisson regression (exponential link)</p></td>
<td><p><span class="math notranslate nohighlight">\(\text{Poisson}(e^{w^\top x + b})\)</span></p></td>
<td><p><a class="reference internal" href="generated/tick.linear_model.SimuPoisReg.html#tick.linear_model.SimuPoisReg" title="tick.linear_model.SimuPoisReg"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimuPoisReg</span></code></a> with <code class="docutils literal notranslate"><span class="pre">link=&quot;exponential&quot;</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">=============================</span>
<span class="sd">Linear models data simulation</span>
<span class="sd">=============================</span>

<span class="sd">Generates Linear, Logistic and Poisson regression realizations given a </span>
<span class="sd">weight vector.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">tick.linear_model</span> <span class="kn">import</span> <span class="n">SimuLinReg</span><span class="p">,</span> <span class="n">SimuLogReg</span><span class="p">,</span> <span class="n">SimuPoisReg</span>

<span class="n">n_samples</span><span class="p">,</span> <span class="n">n_features</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">2</span>

<span class="n">weights0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="n">intercept0</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">simu_linreg</span> <span class="o">=</span> <span class="n">SimuLinReg</span><span class="p">(</span><span class="n">weights0</span><span class="p">,</span> <span class="n">intercept0</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
                         <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">X_linreg</span><span class="p">,</span> <span class="n">y_linreg</span> <span class="o">=</span> <span class="n">simu_linreg</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>

<span class="n">simu_logreg</span> <span class="o">=</span> <span class="n">SimuLogReg</span><span class="p">(</span><span class="n">weights0</span><span class="p">,</span> <span class="n">intercept0</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
                         <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">X_logreg</span><span class="p">,</span> <span class="n">y_logreg</span> <span class="o">=</span> <span class="n">simu_logreg</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>

<span class="n">simu_poisreg</span> <span class="o">=</span> <span class="n">SimuPoisReg</span><span class="p">(</span><span class="n">weights0</span><span class="p">,</span> <span class="n">intercept0</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span>
                           <span class="n">link</span><span class="o">=</span><span class="s1">&#39;exponential&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">X_poisreg</span><span class="p">,</span> <span class="n">y_poisreg</span> <span class="o">=</span> <span class="n">simu_poisreg</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">X_linreg</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">y_linreg</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Linear&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">X_logreg</span><span class="p">[</span><span class="n">y_logreg</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y_i=1$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">X_logreg</span><span class="p">[</span><span class="n">y_logreg</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y_i=-1$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Logistic&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">X_poisreg</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">y_poisreg</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Poisson&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../examples/plot_simulation_linear_model.py">Source code</a>, <a class="reference external" href="../../examples/plot_simulation_linear_model.png">png</a>, <a class="reference external" href="../../examples/plot_simulation_linear_model.hires.png">hires.png</a>, <a class="reference external" href="../../examples/plot_simulation_linear_model.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/plot_simulation_linear_model2.png" src="../_images/plot_simulation_linear_model2.png" />
</div>
</div>
</div>


</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright Emmanuel Bacry, Martin Bompaire, Stephane Gaiffas, Maryan Morel, Søren Vinther Poulsen.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>